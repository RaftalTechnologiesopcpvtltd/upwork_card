{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
<style>
    /* #navbarTwo {
        display: none !important;
    }

    .navbar-btn {
        margin-left: auto;
    } */

    .prod_loader-container {
        text-align: center;
        position: relative;
    }

    .prod_loader {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        border: 6px solid transparent;
        border-top: 6px solid #001531;
        border-bottom: 6px solid #001531;
        animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    .prod_pulse {
        position: absolute;
        width: 90px;
        height: 90px;
        background: rgba(0, 21, 49, 0.2);
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        animation: pulseEffect 1.5s infinite;
    }

    @keyframes pulseEffect {
        0% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        100% {
            transform: translate(-50%, -50%) scale(1.5);
            opacity: 0;
        }
    }

    .prod_loading-text {
        margin-top: 20px;
        font-size: 1.2rem;
        font-weight: 500;
        color: #001531;
        letter-spacing: 1px;
    }

    body {
        background-color: #f4f7fe !important;
    }

    label {
        font-size: 18px;
        font-weight: 700;
    }

    .clear_btn {
        border-color: #001531;
        color: #001531;
    }

    .clear_btn:hover {
        background-color: #001531;
        color: #fafafa;

    }

    .category-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, 300px);
        gap: 10px;
        justify-content: space-evenly;
    }

    .openProductModal {
        border-radius: 15px;
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s, box-shadow 0.3s;
    }

    .openProductModal:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    }



    /* Product Card Container */
    .product-card {
        width: 100%;
        max-width: 18rem;
        background-color: #EBF4F3;
        border: none;
        border-radius: 8px;
        overflow: hidden;
        position: relative;
        padding: 15px;
        text-align: center;
        transition: 0.3s ease-in-out;
    }

    /* Ribbon Style */
    .ribbon {
        position: absolute;
        top: 85px;
        left: -30px;
        width: 162px;
        height: 37px;
        /* Adjust height as needed */
        background-color: #ff4d4d;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        font-weight: bold;
        transform: rotate(-45deg);
        /* Tilt the ribbon */
        transform-origin: top left;
        z-index: 10;
        box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.2);
    }



    /* Product Image Styling */
    .product-image {
        display: flex;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 230px;
        overflow: hidden;
    }

    .product-image img {
        max-width: 100%;
        max-height: 100%;
        object-fit: cover;
    }

    /* Product Title */
    .product-title {
        font-size: 18px;
        font-weight: 700;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .product-card {
            max-width: 100%;
        }
    }




    .carousel-item::before {
        background: none !important;
    }



    .changing_btn:hover {
        border: 1px solid #001531;
        background: white;
        color: #001531;
    }

    .changing_btn i:hover {
        color: #001531;
    }

    /* .carousel-control-prev {
        left: 0 !important;
    }

    .carousel-control-next {
        right: 0 !important;
    }

    .headings_clr {
        color: #001531;
    } */

    /* Ensure indicators are centered and aligned properly */
    #productCarousel .carousel-indicators {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 6px;
        /* Space between bars */
        list-style: none;
        padding: 0;
        margin: 0;
        z-index: 10;
    }

    /* Base styling for the bars */
    #productCarousel .carousel-indicators [data-bs-target] {
        width: 25px;
        /* Default width */
        height: 6px;
        /* Default height */
        background-color: rgba(255, 255, 255, 0.6);
        /* Light bar */
        border-radius: 3px;
        transition: all 0.3s ease-in-out;
        cursor: pointer;
        min-width: 18px;
        /* Ensures visibility on small screens */
        min-height: 5px;
    }

    /* Active bar styling */
    #productCarousel .carousel-indicators .active {
        width: 35px;
        /* Bigger active bar */
        height: 7px;
        /* Slightly taller */
        background-color: #001531;
        /* Active bar color */
        min-width: 22px;
        min-height: 6px;
    }

    .selling_price {
        font-size: 1.1rem;
        font-weight: 700;
        color: #28a745;
    }

    .bid {
        font-size: 1.1rem;
        color: #007bff;
    }

    .date {
        font-size: 0.9rem;
        color: #6c757d;
    }

    .carousel-inner {
        padding: 10px;
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
        #productCarousel .carousel-indicators {
            bottom: 8px;
            gap: 5px;
        }

        #productCarousel .carousel-indicators [data-bs-target] {
            width: 20px;
            height: 5px;
            min-width: 16px;
            min-height: 4px;
        }

        #productCarousel .carousel-indicators .active {
            width: 28px;
            height: 6px;
            min-width: 18px;
            min-height: 5px;
        }
    }

    @media (max-width: 480px) {
        #productCarousel .carousel-indicators {
            bottom: 6px;
            gap: 4px;
        }

        #productCarousel .carousel-indicators [data-bs-target] {
            width: 18px;
            height: 4px;
            min-width: 14px;
            min-height: 3px;
        }

        #productCarousel .carousel-indicators .active {
            width: 24px;
            height: 5px;
            min-width: 16px;
            min-height: 4px;
        }
    }

    .auction-box,
    .fixed-price-box {
        padding: 15px;
        margin: 10px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        text-align: center;
        color: white;
        display: inline-block;
        width: 200px;
    }

    /* Auction Style - Neon Red */
    .auction-box {
        /* Bright neon red */
        border: 2px solid #ff2200;
        color: #ff2200;
        /* White text for contrast */
        padding: 10px;
        border-radius: 8px;
    }

    /* Fixed Price Style - Neon Blue */
    .fixed-price-box {
        /* Bright neon blue */
        border: 2px solid #008000;
        color: #008000;
        /* White text for contrast */
        padding: 10px;
        border-radius: 8px;
    }
</style>

<div class="d-flex align-items-center justify-content-end nav_section_block">
    <!-- <div class="container banner-text-container" style="color: #dee7e9;">
        <div style="font-size: 36px">
            <b>My Subscription</b>
        </div>
        <p style="color: #dee7e9;">Home.Pages.<span class="" style="color: #dee7e9;"><b>My Subscription</b></span></p>
    </div> -->
</div>
<section id="dashboard">
    <div class="container my-5">
        <div class="row justify-content-center">
            <div class="col-lg-6 col-md-10">
                <div class="section-title text-center pb-25">
                    <h3 class="title">Search Your Products!!</h3>
                    <!-- <p class="text">Search Your Products with the Given Filters!!</p> -->
                </div> <!-- section title -->
            </div>
        </div> <!-- row -->

        <div class="card mb-4">
            <div class="card-body">
                <div class="row">
                    <div class="col-lg-12 mb-3">
                        <label for="searchInput" class="form-label">Search</label>
                        <input type="text" id="searchInput" class="form-control" placeholder="Type to search...">
                        <div id="suggestions" class="suggestions"></div>
                    </div>
                    <div class="col-lg-12">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="marketplaceFilter" class="form-label">Marketplace</label>
                                <select id="marketplaceFilter" class="form-control">
                                    <option value="">Select Marketplace</option>
                                    <option value="all">All</option>
                                    <option value="fivemiles">5 Miles</option>
                                    <option value="craigslist">Craigslist</option>
                                    <option value="fanatics">Fanatics Collect</option>
                                    <option value="ebay">Ebay</option>
                                    <!-- <option value="facebook">Facebook Marketplace</option> -->
                                    <option value="offerup">Offerup</option>
                                    <option value="mercari">Mercari</option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="locationFilter" class="form-label">Location</label>
                                <select id="locationFilter" class="form-control">
                                    <option value="">Select Location</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="row">
                            <div id="sortContainer" style="display: none;" class="col-md-6 mb-3">
                                <label for="sortSelect" class="form-label">Sort By</label>
                                <select id="sortSelect" class="form-control">
                                    <option value="default">Default</option>
                                    <option value="low_to_high">Price: Low to High</option>
                                    <option value="high_to_low">Price: High to Low</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <button id="searchBtn" class="btn-subscribe btn-dark-custom btn mr-2">Search</button>
                    <button id="clearBtn" class="btn btn-subscribe clear_btn">Clear All</button>
                </div>
            </div>
        </div>

        <div id="results">
            <!-- Example result item -->
            <div class="category-container">

            </div>
            <!-- More result items will be dynamically added here -->
        </div>
        <!-- Product Modal -->
        <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-centered">
                <div class="modal-content border-0 shadow">
                    <div class="modal-header border-0 bg-light">
                        <h5 class="modal-title visually-hidden" id="productTitle">Product Details</h5>
                        <button type="button" class="btn btn-close" data-bs-dismiss="modal" aria-label="Close"><i
                                class="fa-solid fa-xmark"></i></button>
                    </div>
                    <div class="modal-body p-0">
                        <div class="row g-0">
                            <!-- Product Images Carousel - Left Side -->
                            <div class="col-lg-6">
                                <div id="productCarousel" class="carousel slide">
                                    <div class="carousel-indicators" id="carouselIndicators">
                                    </div>
                                    <div class="carousel-inner">
                                    </div>
                                    <button class="carousel-control-prev" type="button"
                                        data-bs-target="#productCarousel" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Previous</span>
                                    </button>
                                    <button class="carousel-control-next" type="button"
                                        data-bs-target="#productCarousel" data-bs-slide="next">
                                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                        <span class="visually-hidden">Next</span>
                                    </button>
                                </div>
                            </div>

                            <!-- Product Information - Right Side -->
                            <div class="col-lg-6">
                                <div class="p-4 p-lg-5">
                                    <div class="d-flex justify-content-between align-items-start mb-3">
                                        <div>
                                            <h2 class="h3 fw-bold mb-1" id="productTitlebtm"></h2>
                                        </div>
                                        <div id="sellingtype" class="badge p-2 fs-6"></div>
                                    </div>

                                    <div class="d-flex align-items-center mb-4">
                                        <h3 id="productPrice" class="h4 fw-bold mb-0 me-3"></h3>
                                    </div>

                                    <div class="mb-4" id="biddinginfo">
                                        <h4 class="h6 fw-bold mb-3">Bidding Information</h4>
                                        <div class="d-flex flex-wrap">
                                            <div class="mr-4 mb-2">
                                                <span class="d-block text-muted small">Current Bid</span>
                                                <span id="currentBid" class="fw-bold"></span>
                                            </div>
                                            <div class="mr-4 mb-2">
                                                <span class="d-block text-muted small">Bids</span>
                                                <span id="bidCount" class="fw-bold"></span>
                                            </div>
                                            <div class="mb-2">
                                                <span class="d-block text-muted small">Auction Id</span>
                                                <span id="auctionId" class="fw-bold"></span>
                                            </div>
                                        </div>
                                    </div>

                                    <ul class="nav nav-tabs mb-3" id="productTabs" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" id="description-tab" data-bs-toggle="tab"
                                                data-bs-target="#description" type="button" role="tab"
                                                aria-controls="description" aria-selected="true">
                                                Description
                                            </button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="specs-tab" data-bs-toggle="tab"
                                                data-bs-target="#specs" type="button" role="tab" aria-controls="specs"
                                                aria-selected="false">
                                                Condition
                                            </button>
                                        </li>
                                    </ul>

                                    <div class="tab-content" id="productTabContent">
                                        <div class="tab-pane fade show active" id="description" role="tabpanel"
                                            aria-labelledby="description-tab">
                                            <p id="productDescription"></p>
                                        </div>
                                        <div class="tab-pane fade" id="specs" role="tabpanel"
                                            aria-labelledby="specs-tab">
                                            <ul class="list-unstyled">
                                                <li class="mb-2" id="condition"></li>
                                                <li class="mb-2" id="conditionInfo"></li>
                                            </ul>
                                        </div>
                                    </div>

                                    <div class="d-flex flex-wrap gap-2 mt-4" id="prod_btns">
                                        <a id="websiteUrl" target="_blank" class="mb-2 btn btn-primary mr-2">Visit
                                            Website</a>
                                        <a id="productLink" target="_blank" class="mb-2 btn btn-outline-primary">Visit
                                            Product</a>
                                        <!-- <a href="#" class="add-to-fav"><i style="height: 15px; opacity: 0.8;"
                                                color="black" class="fa fa-heart" aria-hidden="true"></i></a> -->

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</section>


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!-- Toastr CSS -->


<!-- Toastr JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> -->
<script>


    $(document).ready(function () {
        let currentProducts = [];

        function getProductPrice(product) {
            let priceStr = product.selling_type === "Auction"
                ? product.current_bid_price
                : product.product_price;

            if (typeof priceStr === "string") {
                priceStr = priceStr.replace(/\$/g, "").replace(/,/g, "").trim();
            }

            const price = parseFloat(priceStr);
            return isNaN(price) ? 0.0 : price;
        }

        function sortProducts(products, sortType) {
            let sorted = [...products]; // clone

            if (sortType === "low_to_high") {
                sorted.sort((a, b) => getProductPrice(a) - getProductPrice(b));
            } else if (sortType === "high_to_low") {
                sorted.sort((a, b) => getProductPrice(b) - getProductPrice(a));
            }

            return sorted;
        }

        function renderProducts(products) {
            let resultsContainer = $(".category-container");
            resultsContainer.empty();

            if (products.length === 0) {
                resultsContainer.html("<p>No products found.</p>");
                return;
            }

            products.forEach(product => {
                productData[product.id] = product;

                let productHTML = `
            <div class="my-5 openProductModal position-relative" data-product-id="${product.id}" 
                data-bs-toggle="modal" data-bs-target="#productModal" style="overflow:hidden;">
                
                <div class="ribbon">${product.website_name || "Unknown"}</div> 

                <div style="border-radius: 0; background-color: #EBF4F3; border: none; overflow: hidden;">
                    <div style="display: flex; justify-content: center; height: 230.5px; width: 230.5px; overflow: hidden; padding: 8%; margin-left: 12%;">
                        <img src="${product.product_images[0]}" class="img-fluid" alt="${product.product_title}">
                    </div>
                </div>
                <div class="p-3">
                    <h5 class="mt-4 card-title" style="font-size: 18px; font-weight: 700;">
                        ${product.product_title}
                    </h5>

                    <h6 class="mt-4 card-title ${String(product.selling_type).includes('Auction') ? 'auction-box' : 'fixed-price-box'}">
                        ${product.selling_type || "Unknown"}
                    </h6>                                       

                    ${String(product.selling_type).includes('Auction') ? `
                        <p class="bid mb-1"><i class="fas fa-gavel me-2"></i> Current Bid Price: $${product.current_bid_price || "N/A"}</p>
                        <p class="bid mb-1"><i class="fas fa-gavel me-2"></i> Current Bid Count: ${product.current_bid_count || "N/A"}</p>
                    ` : `
                        <p class="selling_price mb-1">Selling Price: $${product.product_price || "N/A"}</p>
                    `}

                    <p class="date mb-3"><i class="far fa-calendar-alt me-2"></i> ${product.date || "N/A"}</p>
                </div>
            </div>
        `;

                resultsContainer.append(productHTML);
            });
        }
        let productData = {}; // Store all product data globally
        let LocationHTML = `<option value="auburn">Auburn</option>
                            <option value="birmingham">Birmingham</option>
                            <option value="dothan">Dothan</option>
                            <option value="florence / muscle shoals">Florence / muscle shoals</option>
                            <option value="gadsden-anniston">Gadsden-anniston</option>
                            <option value="huntsville / decatur">Huntsville / decatur</option>
                            <option value="mobile">Mobile</option>
                            <option value="montgomery">Montgomery</option>
                            <option value="tuscaloosa">Tuscaloosa</option>
                            <option value="anchorage / mat-su">Anchorage / mat-su</option>
                            <option value="fairbanks">Fairbanks</option>
                            <option value="kenai peninsula">Kenai peninsula</option>
                            <option value="southeast alaska">Southeast alaska</option>
                            <option value="flagstaff / sedona">Flagstaff / sedona</option>
                            <option value="mohave county">Mohave county</option>
                            <option value="phoenix">Phoenix</option>
                            <option value="prescott">Prescott</option>
                            <option value="show low">Show low</option>
                            <option value="sierra vista">Sierra vista</option>
                            <option value="tucson">Tucson</option>
                            <option value="yuma">Yuma</option>
                            <option value="fayetteville">Fayetteville</option>
                            <option value="fort smith">Fort smith</option>
                            <option value="jonesboro">Jonesboro</option>
                            <option value="little rock">Little rock</option>
                            <option value="texarkana">Texarkana</option>
                            <option value="bakersfield">Bakersfield</option>
                            <option value="chico">Chico</option>
                            <option value="fresno / madera">Fresno / madera</option>
                            <option value="gold country">Gold country</option>
                            <option value="hanford-corcoran">Hanford-corcoran</option>
                            <option value="humboldt county">Humboldt county</option>
                            <option value="imperial county">Imperial county</option>
                            <option value="inland empire">Inland empire</option>
                            <option value="los angeles">Los angeles</option>
                            <option value="mendocino county">Mendocino county</option>
                            <option value="merced">Merced</option>
                            <option value="modesto">Modesto</option>
                            <option value="monterey bay">Monterey bay</option>
                            <option value="orange county">Orange county</option>
                            <option value="palm springs">Palm springs</option>
                            <option value="redding">Redding</option>
                            <option value="sacramento">Sacramento</option>
                            <option value="san diego">San diego</option>
                            <option value="san francisco bay area">San francisco bay area</option>
                            <option value="san luis obispo">San luis obispo</option>
                            <option value="santa barbara">Santa barbara</option>
                            <option value="santa maria">Santa maria</option>
                            <option value="siskiyou county">Siskiyou county</option>
                            <option value="stockton">Stockton</option>
                            <option value="susanville">Susanville</option>
                            <option value="ventura county">Ventura county</option>
                            <option value="visalia-tulare">Visalia-tulare</option>
                            <option value="yuba-sutter">Yuba-sutter</option>
                            <option value="boulder">Boulder</option>
                            <option value="colorado springs">Colorado springs</option>
                            <option value="denver">Denver</option>
                            <option value="eastern CO">Eastern co</option>
                            <option value="fort collins / north CO">Fort collins / north co</option>
                            <option value="high rockies">High rockies</option>
                            <option value="pueblo">Pueblo</option>
                            <option value="western slope">Western slope</option>
                            <option value="eastern CT">Eastern ct</option>
                            <option value="hartford">Hartford</option>
                            <option value="new haven">New haven</option>
                            <option value="northwest CT">Northwest ct</option>
                            <option value="delaware">Delaware</option>
                            <option value="washington">Washington</option>
                            <option value="broward county">Broward county</option>
                            <option value="daytona beach">Daytona beach</option>
                            <option value="florida keys">Florida keys</option>
                            <option value="fort lauderdale">Fort lauderdale</option>
                            <option value="ft myers / SW florida">Ft myers / sw florida</option>
                            <option value="gainesville">Gainesville</option>
                            <option value="heartland florida">Heartland florida</option>
                            <option value="jacksonville">Jacksonville</option>
                            <option value="lakeland">Lakeland</option>
                            <option value="miami / dade">Miami / dade</option>
                            <option value="north central FL">North central fl</option>
                            <option value="ocala">Ocala</option>
                            <option value="okaloosa / walton">Okaloosa / walton</option>
                            <option value="orlando">Orlando</option>
                            <option value="panama city">Panama city</option>
                            <option value="pensacola">Pensacola</option>
                            <option value="sarasota-bradenton">Sarasota-bradenton</option>
                            <option value="south florida">South florida</option>
                            <option value="space coast">Space coast</option>
                            <option value="st augustine">St augustine</option>
                            <option value="tallahassee">Tallahassee</option>
                            <option value="tampa bay area">Tampa bay area</option>
                            <option value="treasure coast">Treasure coast</option>
                            <option value="palm beach county">Palm beach county</option>
                            <option value="albany">Albany</option>
                            <option value="athens">Athens</option>
                            <option value="atlanta">Atlanta</option>
                            <option value="augusta">Augusta</option>
                            <option value="brunswick">Brunswick</option>
                            <option value="columbus">Columbus</option>
                            <option value="macon / warner robins">Macon / warner robins</option>
                            <option value="northwest GA">Northwest ga</option>
                            <option value="savannah / hinesville">Savannah / hinesville</option>
                            <option value="statesboro">Statesboro</option>
                            <option value="valdosta">Valdosta</option>
                            <option value="hawaii">Hawaii</option>
                            <option value="boise">Boise</option>
                            <option value="east idaho">East idaho</option>
                            <option value="lewiston / clarkston">Lewiston / clarkston</option>
                            <option value="twin falls">Twin falls</option>
                            <option value="bloomington-normal">Bloomington-normal</option>
                            <option value="champaign urbana">Champaign urbana</option>
                            <option value="chicago">Chicago</option>
                            <option value="decatur">Decatur</option>
                            <option value="la salle co">La salle co</option>
                            <option value="mattoon-charleston">Mattoon-charleston</option>
                            <option value="peoria">Peoria</option>
                            <option value="rockford">Rockford</option>
                            <option value="southern illinois">Southern illinois</option>
                            <option value="springfield">Springfield</option>
                            <option value="western IL">Western il</option>
                            <option value="bloomington">Bloomington</option>
                            <option value="evansville">Evansville</option>
                            <option value="fort wayne">Fort wayne</option>
                            <option value="indianapolis">Indianapolis</option>
                            <option value="kokomo">Kokomo</option>
                            <option value="lafayette / west lafayette">Lafayette / west lafayette</option>
                            <option value="muncie / anderson">Muncie / anderson</option>
                            <option value="richmond">Richmond</option>
                            <option value="south bend / michiana">South bend / michiana</option>
                            <option value="terre haute">Terre haute</option>
                            <option value="ames">Ames</option>
                            <option value="cedar rapids">Cedar rapids</option>
                            <option value="des moines">Des moines</option>
                            <option value="dubuque">Dubuque</option>
                            <option value="fort dodge">Fort dodge</option>
                            <option value="iowa city">Iowa city</option>
                            <option value="mason city">Mason city</option>
                            <option value="quad cities">Quad cities</option>
                            <option value="sioux city">Sioux city</option>
                            <option value="southeast IA">Southeast ia</option>
                            <option value="waterloo / cedar falls">Waterloo / cedar falls</option>
                            <option value="lawrence">Lawrence</option>
                            <option value="manhattan">Manhattan</option>
                            <option value="northwest KS">Northwest ks</option>
                            <option value="salina">Salina</option>
                            <option value="southeast KS">Southeast ks</option>
                            <option value="southwest KS">Southwest ks</option>
                            <option value="topeka">Topeka</option>
                            <option value="wichita">Wichita</option>
                            <option value="bowling green">Bowling green</option>
                            <option value="eastern kentucky">Eastern kentucky</option>
                            <option value="lexington">Lexington</option>
                            <option value="louisville">Louisville</option>
                            <option value="owensboro">Owensboro</option>
                            <option value="western KY">Western ky</option>
                            <option value="baton rouge">Baton rouge</option>
                            <option value="central louisiana">Central louisiana</option>
                            <option value="houma">Houma</option>
                            <option value="lafayette">Lafayette</option>
                            <option value="lake charles">Lake charles</option>
                            <option value="monroe">Monroe</option>
                            <option value="new orleans">New orleans</option>
                            <option value="shreveport">Shreveport</option>
                            <option value="maine">Maine</option>
                            <option value="annapolis">Annapolis</option>
                            <option value="baltimore">Baltimore</option>
                            <option value="eastern shore">Eastern shore</option>
                            <option value="frederick">Frederick</option>
                            <option value="southern maryland">Southern maryland</option>
                            <option value="western maryland">Western maryland</option>
                            <option value="boston">Boston</option>
                            <option value="cape cod / islands">Cape cod / islands</option>
                            <option value="south coast">South coast</option>
                            <option value="western massachusetts">Western massachusetts</option>
                            <option value="worcester / central MA">Worcester / central ma</option>
                            <option value="ann arbor">Ann arbor</option>
                            <option value="battle creek">Battle creek</option>
                            <option value="central michigan">Central michigan</option>
                            <option value="detroit metro">Detroit metro</option>
                            <option value="flint">Flint</option>
                            <option value="grand rapids">Grand rapids</option>
                            <option value="holland">Holland</option>
                            <option value="jackson">Jackson</option>
                            <option value="kalamazoo">Kalamazoo</option>
                            <option value="lansing">Lansing</option>
                            <option value="monroe">Monroe</option>
                            <option value="muskegon">Muskegon</option>
                            <option value="northern michigan">Northern michigan</option>
                            <option value="port huron">Port huron</option>
                            <option value="saginaw-midland-baycity">Saginaw-midland-baycity</option>
                            <option value="southwest michigan">Southwest michigan</option>
                            <option value="the thumb">The thumb</option>
                            <option value="upper peninsula">Upper peninsula</option>
                            <option value="bemidji">Bemidji</option>
                            <option value="brainerd">Brainerd</option>
                            <option value="duluth / superior">Duluth / superior</option>
                            <option value="mankato">Mankato</option>
                            <option value="minneapolis / st paul">Minneapolis / st paul</option>
                            <option value="rochester">Rochester</option>
                            <option value="southwest MN">Southwest mn</option>
                            <option value="st cloud">St cloud</option>
                            <option value="gulfport / biloxi">Gulfport / biloxi</option>
                            <option value="hattiesburg">Hattiesburg</option>
                            <option value="jackson">Jackson</option>
                            <option value="meridian">Meridian</option>
                            <option value="north mississippi">North mississippi</option>
                            <option value="southwest MS">Southwest ms</option>
                            <option value="columbia / jeff city">Columbia / jeff city</option>
                            <option value="joplin">Joplin</option>
                            <option value="kansas city">Kansas city</option>
                            <option value="kirksville">Kirksville</option>
                            <option value="lake of the ozarks">Lake of the ozarks</option>
                            <option value="southeast missouri">Southeast missouri</option>
                            <option value="springfield">Springfield</option>
                            <option value="st joseph">St joseph</option>
                            <option value="st louis">St louis</option>
                            <option value="billings">Billings</option>
                            <option value="bozeman">Bozeman</option>
                            <option value="butte">Butte</option>
                            <option value="great falls">Great falls</option>
                            <option value="helena">Helena</option>
                            <option value="kalispell">Kalispell</option>
                            <option value="missoula">Missoula</option>
                            <option value="eastern montana">Eastern montana</option>
                            <option value="grand island">Grand island</option>
                            <option value="lincoln">Lincoln</option>
                            <option value="north platte">North platte</option>
                            <option value="omaha / council bluffs">Omaha / council bluffs</option>
                            <option value="scottsbluff / panhandle">Scottsbluff / panhandle</option>
                            <option value="elko">Elko</option>
                            <option value="las vegas">Las vegas</option>
                            <option value="reno / tahoe">Reno / tahoe</option>
                            <option value="new hampshire">New hampshire</option>
                            <option value="central NJ">Central nj</option>
                            <option value="jersey shore">Jersey shore</option>
                            <option value="north jersey">North jersey</option>
                            <option value="south jersey">South jersey</option>
                            <option value="albuquerque">Albuquerque</option>
                            <option value="clovis / portales">Clovis / portales</option>
                            <option value="farmington">Farmington</option>
                            <option value="las cruces">Las cruces</option>
                            <option value="roswell / carlsbad">Roswell / carlsbad</option>
                            <option value="santa fe / taos">Santa fe / taos</option>
                            <option value="albany">Albany</option>
                            <option value="binghamton">Binghamton</option>
                            <option value="buffalo">Buffalo</option>
                            <option value="catskills">Catskills</option>
                            <option value="chautauqua">Chautauqua</option>
                            <option value="elmira-corning">Elmira-corning</option>
                            <option value="finger lakes">Finger lakes</option>
                            <option value="glens falls">Glens falls</option>
                            <option value="hudson valley">Hudson valley</option>
                            <option value="ithaca">Ithaca</option>
                            <option value="long island">Long island</option>
                            <option value="new york city">New york city</option>
                            <option value="oneonta">Oneonta</option>
                            <option value="plattsburgh-adirondacks">Plattsburgh-adirondacks</option>
                            <option value="potsdam-canton-massena">Potsdam-canton-massena</option>
                            <option value="rochester">Rochester</option>
                            <option value="syracuse">Syracuse</option>
                            <option value="twin tiers NY/PA">Twin tiers ny/pa</option>
                            <option value="utica-rome-oneida">Utica-rome-oneida</option>
                            <option value="watertown">Watertown</option>
                            <option value="asheville">Asheville</option>
                            <option value="boone">Boone</option>
                            <option value="charlotte">Charlotte</option>
                            <option value="eastern NC">Eastern nc</option>
                            <option value="fayetteville">Fayetteville</option>
                            <option value="greensboro">Greensboro</option>
                            <option value="hickory / lenoir">Hickory / lenoir</option>
                            <option value="jacksonville">Jacksonville</option>
                            <option value="outer banks">Outer banks</option>
                            <option value="raleigh / durham / CH">Raleigh / durham / ch</option>
                            <option value="wilmington">Wilmington</option>
                            <option value="winston-salem">Winston-salem</option>
                            <option value="bismarck">Bismarck</option>
                            <option value="fargo / moorhead">Fargo / moorhead</option>
                            <option value="grand forks">Grand forks</option>
                            <option value="north dakota">North dakota</option>
                            <option value="akron / canton">Akron / canton</option>
                            <option value="ashtabula">Ashtabula</option>
                            <option value="athens">Athens</option>
                            <option value="chillicothe">Chillicothe</option>
                            <option value="cincinnati">Cincinnati</option>
                            <option value="cleveland">Cleveland</option>
                            <option value="columbus">Columbus</option>
                            <option value="dayton / springfield">Dayton / springfield</option>
                            <option value="lima / findlay">Lima / findlay</option>
                            <option value="mansfield">Mansfield</option>
                            <option value="sandusky">Sandusky</option>
                            <option value="toledo">Toledo</option>
                            <option value="tuscarawas co">Tuscarawas co</option>
                            <option value="youngstown">Youngstown</option>
                            <option value="zanesville / cambridge">Zanesville / cambridge</option>
                            <option value="lawton">Lawton</option>
                            <option value="northwest OK">Northwest ok</option>
                            <option value="oklahoma city">Oklahoma city</option>
                            <option value="stillwater">Stillwater</option>
                            <option value="tulsa">Tulsa</option>
                            <option value="bend">Bend</option>
                            <option value="corvallis/albany">Corvallis/albany</option>
                            <option value="east oregon">East oregon</option>
                            <option value="eugene">Eugene</option>
                            <option value="klamath falls">Klamath falls</option>
                            <option value="medford-ashland">Medford-ashland</option>
                            <option value="oregon coast">Oregon coast</option>
                            <option value="portland">Portland</option>
                            <option value="roseburg">Roseburg</option>
                            <option value="salem">Salem</option>
                            <option value="altoona-johnstown">Altoona-johnstown</option>
                            <option value="cumberland valley">Cumberland valley</option>
                            <option value="erie">Erie</option>
                            <option value="harrisburg">Harrisburg</option>
                            <option value="lancaster">Lancaster</option>
                            <option value="lehigh valley">Lehigh valley</option>
                            <option value="meadville">Meadville</option>
                            <option value="philadelphia">Philadelphia</option>
                            <option value="pittsburgh">Pittsburgh</option>
                            <option value="poconos">Poconos</option>
                            <option value="reading">Reading</option>
                            <option value="scranton / wilkes-barre">Scranton / wilkes-barre</option>
                            <option value="state college">State college</option>
                            <option value="williamsport">Williamsport</option>
                            <option value="york">York</option>
                            <option value="rhode island">Rhode island</option>
                            <option value="charleston">Charleston</option>
                            <option value="columbia">Columbia</option>
                            <option value="florence">Florence</option>
                            <option value="greenville / upstate">Greenville / upstate</option>
                            <option value="hilton head">Hilton head</option>
                            <option value="myrtle beach">Myrtle beach</option>
                            <option value="northeast SD">Northeast sd</option>
                            <option value="pierre / central SD">Pierre / central sd</option>
                            <option value="rapid city / west SD">Rapid city / west sd</option>
                            <option value="sioux falls / SE SD">Sioux falls / se sd</option>
                            <option value="south dakota">South dakota</option>
                            <option value="chattanooga">Chattanooga</option>
                            <option value="clarksville">Clarksville</option>
                            <option value="cookeville">Cookeville</option>
                            <option value="jackson">Jackson</option>
                            <option value="knoxville">Knoxville</option>
                            <option value="memphis">Memphis</option>
                            <option value="nashville">Nashville</option>
                            <option value="tri-cities">Tri-cities</option>
                            <option value="abilene">Abilene</option>
                            <option value="amarillo">Amarillo</option>
                            <option value="austin">Austin</option>
                            <option value="beaumont / port arthur">Beaumont / port arthur</option>
                            <option value="brownsville">Brownsville</option>
                            <option value="college station">College station</option>
                            <option value="corpus christi">Corpus christi</option>
                            <option value="dallas / fort worth">Dallas / fort worth</option>
                            <option value="deep east texas">Deep east texas</option>
                            <option value="del rio / eagle pass">Del rio / eagle pass</option>
                            <option value="el paso">El paso</option>
                            <option value="galveston">Galveston</option>
                            <option value="houston">Houston</option>
                            <option value="killeen / temple / ft hood">Killeen / temple / ft hood</option>
                            <option value="laredo">Laredo</option>
                            <option value="lubbock">Lubbock</option>
                            <option value="mcallen / edinburg">Mcallen / edinburg</option>
                            <option value="odessa / midland">Odessa / midland</option>
                            <option value="san angelo">San angelo</option>
                            <option value="san antonio">San antonio</option>
                            <option value="san marcos">San marcos</option>
                            <option value="southwest TX">Southwest tx</option>
                            <option value="texoma">Texoma</option>
                            <option value="tyler / east TX">Tyler / east tx</option>
                            <option value="victoria">Victoria</option>
                            <option value="waco">Waco</option>
                            <option value="wichita falls">Wichita falls</option>
                            <option value="logan">Logan</option>
                            <option value="ogden-clearfield">Ogden-clearfield</option>
                            <option value="provo / orem">Provo / orem</option>
                            <option value="salt lake city">Salt lake city</option>
                            <option value="st george">St george</option>
                            <option value="vermont">Vermont</option>
                            <option value="charlottesville">Charlottesville</option>
                            <option value="danville">Danville</option>
                            <option value="fredericksburg">Fredericksburg</option>
                            <option value="hampton roads">Hampton roads</option>
                            <option value="harrisonburg">Harrisonburg</option>
                            <option value="lynchburg">Lynchburg</option>
                            <option value="new river valley">New river valley</option>
                            <option value="richmond">Richmond</option>
                            <option value="roanoke">Roanoke</option>
                            <option value="southwest VA">Southwest va</option>
                            <option value="winchester">Winchester</option>
                            <option value="bellingham">Bellingham</option>
                            <option value="kennewick-pasco-richland">Kennewick-pasco-richland</option>
                            <option value="moses lake">Moses lake</option>
                            <option value="olympic peninsula">Olympic peninsula</option>
                            <option value="pullman / moscow">Pullman / moscow</option>
                            <option value="seattle-tacoma">Seattle-tacoma</option>
                            <option value="skagit / island / SJI">Skagit / island / sji</option>
                            <option value="spokane / coeur d'alene">Spokane / coeur d'alene</option>
                            <option value="wenatchee">Wenatchee</option>
                            <option value="yakima">Yakima</option>
                            <option value="charleston">Charleston</option>
                            <option value="eastern panhandle">Eastern panhandle</option>
                            <option value="huntington-ashland">Huntington-ashland</option>
                            <option value="morgantown">Morgantown</option>
                            <option value="northern panhandle">Northern panhandle</option>
                            <option value="parkersburg-marietta">Parkersburg-marietta</option>
                            <option value="southern WV">Southern wv</option>
                            <option value="west virginia (old)">West virginia (old)</option>
                            <option value="appleton-oshkosh-FDL">Appleton-oshkosh-fdl</option>
                            <option value="eau claire">Eau claire</option>
                            <option value="green bay">Green bay</option>
                            <option value="janesville">Janesville</option>
                            <option value="kenosha-racine">Kenosha-racine</option>
                            <option value="la crosse">La crosse</option>
                            <option value="madison">Madison</option>
                            <option value="milwaukee">Milwaukee</option>
                            <option value="northern WI">Northern wi</option>
                            <option value="sheboygan">Sheboygan</option>
                            <option value="wausau">Wausau</option>
                            <option value="wyoming">Wyoming</option>
                            <option value="guam-micronesia">Guam-micronesia</option>
                            <option value="puerto rico">Puerto rico</option>
                            <option value="U.S. virgin islands">U.s. virgin islands</option>
                            <option value="calgary">Calgary</option>
                            <option value="edmonton">Edmonton</option>
                            <option value="ft mcmurray">Ft mcmurray</option>
                            <option value="lethbridge">Lethbridge</option>
                            <option value="medicine hat">Medicine hat</option>
                            <option value="peace river country">Peace river country</option>
                            <option value="red deer">Red deer</option>
                            <option value="cariboo">Cariboo</option>
                            <option value="comox valley">Comox valley</option>
                            <option value="fraser valley">Fraser valley</option>
                            <option value="kamloops">Kamloops</option>
                            <option value="kelowna / okanagan">Kelowna / okanagan</option>
                            <option value="kootenays">Kootenays</option>
                            <option value="nanaimo">Nanaimo</option>
                            <option value="prince george">Prince george</option>
                            <option value="skeena-bulkley">Skeena-bulkley</option>
                            <option value="sunshine coast">Sunshine coast</option>
                            <option value="vancouver">Vancouver</option>
                            <option value="victoria">Victoria</option>
                            <option value="whistler">Whistler</option>
                            <option value="winnipeg">Winnipeg</option>
                            <option value="new brunswick">New brunswick</option>
                            <option value="st john's">St john's</option>
                            <option value="territories">Territories</option>
                            <option value="yellowknife">Yellowknife</option>
                            <option value="halifax">Halifax</option>
                            <option value="barrie">Barrie</option>
                            <option value="belleville">Belleville</option>
                            <option value="brantford-woodstock">Brantford-woodstock</option>
                            <option value="chatham-kent">Chatham-kent</option>
                            <option value="cornwall">Cornwall</option>
                            <option value="guelph">Guelph</option>
                            <option value="hamilton-burlington">Hamilton-burlington</option>
                            <option value="kingston">Kingston</option>
                            <option value="kitchener-waterloo-cambridge">Kitchener-waterloo-cambridge</option>
                            <option value="london">London</option>
                            <option value="niagara region">Niagara region</option>
                            <option value="ottawa-hull-gatineau">Ottawa-hull-gatineau</option>
                            <option value="owen sound">Owen sound</option>
                            <option value="peterborough">Peterborough</option>
                            <option value="sarnia">Sarnia</option>
                            <option value="sault ste marie">Sault ste marie</option>
                            <option value="sudbury">Sudbury</option>
                            <option value="thunder bay">Thunder bay</option>
                            <option value="toronto">Toronto</option>
                            <option value="windsor">Windsor</option>
                            <option value="prince edward island">Prince edward island</option>
                            <option value="montreal">Montreal</option>
                            <option value="quebec city">Quebec city</option>
                            <option value="saguenay">Saguenay</option>
                            <option value="sherbrooke">Sherbrooke</option>
                            <option value="trois-rivieres">Trois-rivieres</option>
                            <option value="regina">Regina</option>
                            <option value="saskatoon">Saskatoon</option>
                            <option value="whitehorse">Whitehorse</option>
                            <option value="vienna">Vienna</option>
                            <option value="belgium">Belgium</option>
                            <option value="bulgaria">Bulgaria</option>
                            <option value="croatia">Croatia</option>
                            <option value="prague">Prague</option>
                            <option value="copenhagen">Copenhagen</option>
                            <option value="finland">Finland</option>
                            <option value="bordeaux">Bordeaux</option>
                            <option value="brittany">Brittany</option>
                            <option value="grenoble">Grenoble</option>
                            <option value="lille">Lille</option>
                            <option value="loire valley">Loire valley</option>
                            <option value="lyon">Lyon</option>
                            <option value="marseille">Marseille</option>
                            <option value="montpellier">Montpellier</option>
                            <option value="nice / cote d'azur">Nice / cote d'azur</option>
                            <option value="normandy">Normandy</option>
                            <option value="paris">Paris</option>
                            <option value="strasbourg">Strasbourg</option>
                            <option value="toulouse">Toulouse</option>
                            <option value="berlin">Berlin</option>
                            <option value="bremen">Bremen</option>
                            <option value="cologne">Cologne</option>
                            <option value="dresden">Dresden</option>
                            <option value="dusseldorf">Dusseldorf</option>
                            <option value="essen / ruhr">Essen / ruhr</option>
                            <option value="frankfurt">Frankfurt</option>
                            <option value="hamburg">Hamburg</option>
                            <option value="hannover">Hannover</option>
                            <option value="heidelberg">Heidelberg</option>
                            <option value="kaiserslautern">Kaiserslautern</option>
                            <option value="leipzig">Leipzig</option>
                            <option value="munich">Munich</option>
                            <option value="nuremberg">Nuremberg</option>
                            <option value="stuttgart">Stuttgart</option>
                            <option value="greece">Greece</option>
                            <option value="budapest">Budapest</option>
                            <option value="reykjavik">Reykjavik</option>
                            <option value="dublin">Dublin</option>
                            <option value="bologna">Bologna</option>
                            <option value="florence / tuscany">Florence / tuscany</option>
                            <option value="genoa">Genoa</option>
                            <option value="milan">Milan</option>
                            <option value="napoli / campania">Napoli / campania</option>
                            <option value="perugia">Perugia</option>
                            <option value="rome">Rome</option>
                            <option value="sardinia">Sardinia</option>
                            <option value="sicilia">Sicilia</option>
                            <option value="torino">Torino</option>
                            <option value="venice / veneto">Venice / veneto</option>
                            <option value="luxembourg">Luxembourg</option>
                            <option value="amsterdam / randstad">Amsterdam / randstad</option>
                            <option value="norway">Norway</option>
                            <option value="poland">Poland</option>
                            <option value="faro / algarve">Faro / algarve</option>
                            <option value="lisbon">Lisbon</option>
                            <option value="porto">Porto</option>
                            <option value="romania">Romania</option>
                            <option value="moscow">Moscow</option>
                            <option value="st petersburg">St petersburg</option>
                            <option value="alicante">Alicante</option>
                            <option value="baleares">Baleares</option>
                            <option value="barcelona">Barcelona</option>
                            <option value="bilbao">Bilbao</option>
                            <option value="cadiz">Cadiz</option>
                            <option value="canarias">Canarias</option>
                            <option value="granada">Granada</option>
                            <option value="madrid">Madrid</option>
                            <option value="malaga">Malaga</option>
                            <option value="sevilla">Sevilla</option>
                            <option value="valencia">Valencia</option>
                            <option value="sweden">Sweden</option>
                            <option value="basel">Basel</option>
                            <option value="bern">Bern</option>
                            <option value="geneva">Geneva</option>
                            <option value="lausanne">Lausanne</option>
                            <option value="zurich">Zurich</option>
                            <option value="turkey">Turkey</option>
                            <option value="ukraine">Ukraine</option>
                            <option value="aberdeen">Aberdeen</option>
                            <option value="bath">Bath</option>
                            <option value="belfast">Belfast</option>
                            <option value="birmingham / west mids">Birmingham / west mids</option>
                            <option value="brighton">Brighton</option>
                            <option value="bristol">Bristol</option>
                            <option value="cambridge, UK">Cambridge, uk</option>
                            <option value="cardiff / wales">Cardiff / wales</option>
                            <option value="coventry">Coventry</option>
                            <option value="derby">Derby</option>
                            <option value="devon & cornwall">Devon & cornwall</option>
                            <option value="dundee">Dundee</option>
                            <option value="east anglia">East anglia</option>
                            <option value="east midlands">East midlands</option>
                            <option value="edinburgh">Edinburgh</option>
                            <option value="essex">Essex</option>
                            <option value="glasgow">Glasgow</option>
                            <option value="hampshire">Hampshire</option>
                            <option value="kent">Kent</option>
                            <option value="leeds">Leeds</option>
                            <option value="liverpool">Liverpool</option>
                            <option value="london">London</option>
                            <option value="manchester">Manchester</option>
                            <option value="newcastle / NE england">Newcastle / ne england</option>
                            <option value="nottingham">Nottingham</option>
                            <option value="oxford">Oxford</option>
                            <option value="sheffield">Sheffield</option>
                            <option value="bangladesh">Bangladesh</option>
                            <option value="beijing">Beijing</option>
                            <option value="chengdu">Chengdu</option>
                            <option value="chongqing">Chongqing</option>
                            <option value="dalian">Dalian</option>
                            <option value="guangzhou">Guangzhou</option>
                            <option value="hangzhou">Hangzhou</option>
                            <option value="nanjing">Nanjing</option>
                            <option value="shanghai">Shanghai</option>
                            <option value="shenyang">Shenyang</option>
                            <option value="shenzhen">Shenzhen</option>
                            <option value="wuhan">Wuhan</option>
                            <option value="xi'an">Xi'an</option>
                            <option value="guam-micronesia">Guam-micronesia</option>
                            <option value="hong kong">Hong kong</option>
                            <option value="ahmedabad">Ahmedabad</option>
                            <option value="bangalore">Bangalore</option>
                            <option value="bhubaneswar">Bhubaneswar</option>
                            <option value="chandigarh">Chandigarh</option>
                            <option value="chennai (madras)">Chennai (madras)</option>
                            <option value="delhi">Delhi</option>
                            <option value="goa">Goa</option>
                            <option value="hyderabad">Hyderabad</option>
                            <option value="indore">Indore</option>
                            <option value="jaipur">Jaipur</option>
                            <option value="kerala">Kerala</option>
                            <option value="kolkata (calcutta)">Kolkata (calcutta)</option>
                            <option value="lucknow">Lucknow</option>
                            <option value="mumbai">Mumbai</option>
                            <option value="pune">Pune</option>
                            <option value="surat surat">Surat surat</option>
                            <option value="indonesia">Indonesia</option>
                            <option value="iran">Iran</option>
                            <option value="iraq">Iraq</option>
                            <option value="haifa">Haifa</option>
                            <option value="jerusalem">Jerusalem</option>
                            <option value="tel aviv">Tel aviv</option>
                            <option value="west bank">West bank</option>
                            <option value="fukuoka">Fukuoka</option>
                            <option value="hiroshima">Hiroshima</option>
                            <option value="nagoya">Nagoya</option>
                            <option value="okinawa">Okinawa</option>
                            <option value="osaka-kobe-kyoto">Osaka-kobe-kyoto</option>
                            <option value="sapporo">Sapporo</option>
                            <option value="sendai">Sendai</option>
                            <option value="tokyo">Tokyo</option>
                            <option value="seoul">Seoul</option>
                            <option value="kuwait">Kuwait</option>
                            <option value="beirut, lebanon">Beirut, lebanon</option>
                            <option value="malaysia">Malaysia</option>
                            <option value="pakistan">Pakistan</option>
                            <option value="bacolod">Bacolod</option>
                            <option value="bicol region">Bicol region</option>
                            <option value="cagayan de oro">Cagayan de oro</option>
                            <option value="cebu">Cebu</option>
                            <option value="davao city">Davao city</option>
                            <option value="iloilo">Iloilo</option>
                            <option value="manila">Manila</option>
                            <option value="pampanga">Pampanga</option>
                            <option value="zamboanga">Zamboanga</option>
                            <option value="singapore">Singapore</option>
                            <option value="taiwan">Taiwan</option>
                            <option value="thailand">Thailand</option>
                            <option value="united arab emirates">United arab emirates</option>
                            <option value="vietnam">Vietnam</option>
                            <option value="adelaide">Adelaide</option>
                            <option value="brisbane">Brisbane</option>
                            <option value="cairns">Cairns</option>
                            <option value="canberra">Canberra</option>
                            <option value="darwin">Darwin</option>
                            <option value="gold coast">Gold coast</option>
                            <option value="melbourne">Melbourne</option>
                            <option value="newcastle, NSW">Newcastle, nsw</option>
                            <option value="perth">Perth</option>
                            <option value="sydney">Sydney</option>
                            <option value="tasmania">Tasmania</option>
                            <option value="wollongong">Wollongong</option>
                            <option value="auckland">Auckland</option>
                            <option value="christchurch">Christchurch</option>
                            <option value="dunedin">Dunedin</option>
                            <option value="wellington">Wellington</option>
                            <option value="buenos aires">Buenos aires</option>
                            <option value="bolivia">Bolivia</option>
                            <option value="belo horizonte">Belo horizonte</option>
                            <option value="brasilia">Brasilia</option>
                            <option value="curitiba">Curitiba</option>
                            <option value="fortaleza">Fortaleza</option>
                            <option value="porto alegre">Porto alegre</option>
                            <option value="recife">Recife</option>
                            <option value="rio de janeiro">Rio de janeiro</option>
                            <option value="salvador, bahia">Salvador, bahia</option>
                            <option value="sao paulo">Sao paulo</option>
                            <option value="caribbean islands">Caribbean islands</option>
                            <option value="chile">Chile</option>
                            <option value="colombia">Colombia</option>
                            <option value="costa rica">Costa rica</option>
                            <option value="dominican republic">Dominican republic</option>
                            <option value="ecuador">Ecuador</option>
                            <option value="el salvador">El salvador</option>
                            <option value="guatemala">Guatemala</option>
                            <option value="acapulco">Acapulco</option>
                            <option value="baja california sur">Baja california sur</option>
                            <option value="chihuahua">Chihuahua</option>
                            <option value="ciudad juarez">Ciudad juarez</option>
                            <option value="guadalajara">Guadalajara</option>
                            <option value="guanajuato">Guanajuato</option>
                            <option value="hermosillo">Hermosillo</option>
                            <option value="mazatlan">Mazatlan</option>
                            <option value="mexico city">Mexico city</option>
                            <option value="monterrey">Monterrey</option>
                            <option value="oaxaca">Oaxaca</option>
                            <option value="puebla">Puebla</option>
                            <option value="puerto vallarta">Puerto vallarta</option>
                            <option value="tijuana">Tijuana</option>
                            <option value="veracruz">Veracruz</option>
                            <option value="yucatan">Yucatan</option>
                            <option value="nicaragua">Nicaragua</option>
                            <option value="panama">Panama</option>
                            <option value="peru">Peru</option>
                            <option value="puerto rico">Puerto rico</option>
                            <option value="montevideo">Montevideo</option>
                            <option value="venezuela">Venezuela</option>
                            <option value="virgin islands">Virgin islands</option>
                            <option value="egypt">Egypt</option>
                            <option value="ethiopia">Ethiopia</option>
                            <option value="ghana">Ghana</option>
                            <option value="kenya">Kenya</option>
                            <option value="morocco">Morocco</option>
                            <option value="cape town">Cape town</option>
                            <option value="durban">Durban</option>
                            <option value="johannesburg">Johannesburg</option>
                            <option value="pretoria">Pretoria</option>
                            <option value="tunisia">Tunisia</option>
                            `;

        $("#marketplaceFilter").on("change", function () {
            let marketplace = $(this).val();
            let resultsContainer = $("#locationFilter");

            if (marketplace === 'craigslist' || marketplace === 'all') {
                resultsContainer.html(LocationHTML);
            } else {
                resultsContainer.html(`<option value="">Select Location</option>`);
            }
        });

        $("#searchBtn").on("click", function () {
            let query = $("#searchInput").val().trim();
            let marketplace = $("#marketplaceFilter").val();
            let location = $("#locationFilter").val();

            $.ajax({
                url: "/search/",
                type: "GET",
                data: { query, marketplace, location },
                beforeSend: function () {
                    $(".category-container").html(`<div class="prod_loader-container">
                <div class="prod_pulse"></div>
                <div class="prod_loader"></div>
                <div class="prod_loading-text">Fetching your products...</div>
            </div>`);
                },
                success: function (response) {
                    allFetchedProducts = response.products; // Store all fetched products
                    currentProducts = [...allFetchedProducts]; // Initially set current products to all fetched

                    if (currentProducts.length > 0) {
                        $("#sortContainer").show();  // Show dropdown
                        const sortType = $("#sortSelect").val();
                        const sortedProducts = sortProducts(currentProducts, sortType);
                        renderProducts(sortedProducts);

                        // After successful search, update marketplace filter to act as a filter
                        $("#marketplaceFilter").off("change"); // Remove initial change handler
                        $("#marketplaceFilter").on("change", function () {
                            let selectedMarketplace = $(this).val();
                            console.log("selectedMarketplace : ", selectedMarketplace);
                            if(selectedMarketplace === "fivemiles")
                            {
                                selectedMarketplace = selectedMarketplace.slice(4)
                            }
                            let filteredProducts;
                            if (selectedMarketplace === 'all') {
                                filteredProducts = [...allFetchedProducts];
                            } else {
                                filteredProducts = allFetchedProducts.filter(product => product.website_name && product.website_name.toLowerCase().includes(selectedMarketplace.toLowerCase()));
                            }
                            currentProducts = filteredProducts;
                            const sortType = $("#sortSelect").val();
                            const sortedProducts = sortProducts(currentProducts, sortType);
                            renderProducts(sortedProducts);
                            if (currentProducts.length > 0) {
                                $("#sortContainer").show();
                            } else {
                                $("#sortContainer").hide();
                                $(".category-container").html("<p>No products found for this marketplace.</p>");
                            }
                        });

                    } else {
                        $("#sortContainer").hide();  // Hide dropdown
                        $(".category-container").html("<p>No products found.</p>");
                    }
                },
                error: function () {
                    $(".category-container").html("<p>Error fetching results.</p>");
                }
            });
        });

        //  Whenever user changes sort dropdown, apply sort
        $("#sortSelect").on("change", function () {
            const sortType = $(this).val();
            const sortedProducts = sortProducts(currentProducts, sortType);
            renderProducts(sortedProducts);
        });


        // Clear Filters Button
        $("#clearBtn").on("click", function () {
            $("#searchInput").val("");
            $("#soldFilter").val("");
            $("#locationFilter").val("");
            $("#marketplaceFilter").val("");
            $(".category-container").empty();
            $("#sortContainer").hide();  // Hide dropdown

            // Reset marketplace filter functionality to its initial state
            $("#marketplaceFilter").off("change");
            $("#marketplaceFilter").on("change", function () {
                let marketplace = $(this).val();
                let resultsContainer = $("#locationFilter");
                console.log("selectedMarketplace : ", selectedMarketplace);
                console.log("marketplace : ", marketplace);

                if (marketplace === 'craigslist' || marketplace === 'all') {
                    resultsContainer.html(LocationHTML);
                } else {
                    resultsContainer.html('<option value="">Select Location</option>');
                }
                if (allFetchedProducts.length > 0) {
                    currentProducts = [...allFetchedProducts];
                    if (marketplace !== 'all') {
                        currentProducts = currentProducts.filter(product => product.website_name && product.website_name.toLowerCase().includes(selectedMarketplace.toLowerCase()));
                    }
                    const sortType = $("#sortSelect").val();
                    const sortedProducts = sortProducts(currentProducts, sortType);
                    renderProducts(sortedProducts);
                    if (currentProducts.length > 0) {
                        $("#sortContainer").show();
                    } else {
                        $("#sortContainer").hide();
                        $(".category-container").html("<p>No products found for this marketplace.</p>");
                    }
                }
            });
            currentProducts = [];
            allFetchedProducts = [];
        });
        // Handle modal opening
        $(document).on("click", ".openProductModal", function () {
            let productId = $(this).data("product-id");
            let data = productData[productId];

            if (!data) {
                console.error("Product data not found for ID:", productId);
                return;
            }
            else {
                console.log("Product data found for ID:", productId)
                console.log("Product : ", data);
            }

            let carouselInner = $("#productCarousel .carousel-inner");
            let indicators = $("#carouselIndicators");

            carouselInner.empty();
            indicators.empty();

            let images = Array.isArray(data.product_images) ? data.product_images : (data.product_images ? data.product_images.split(',') : []);

            if (images.length === 0) {
                carouselInner.append(`
                <div class="carousel-item active" style="height: 500px; background: white;">
                    <img src="" class="d-block w-100" alt="No Image Available">
                </div>`);
            } else {
                images.forEach((imgSrc, index) => {
                    let activeClass = index === 0 ? "active" : "";

                    carouselInner.append(`
                    <div class="carousel-item ${activeClass}" style="height: 500px; background: white;">
                        <img src="${imgSrc.trim()}" class="d-block product-image" alt="Product Image" style="height: 100%; object-fit: contain;">
                    </div>`);

                    indicators.append(`
                    <button type="button" data-bs-target="#productCarousel" 
                            data-bs-slide-to="${index}" class="${activeClass}" aria-label="Slide ${index + 1}"></button>`);
                });

                // Add navigation buttons only if multiple images exist
                $(".carousel-control-prev, .carousel-control-next").remove();
                if (images.length > 1) {
                    $("#productCarousel").append(`
                    <button class="carousel-control-prev changing_btn" type="button" 
                            data-bs-target="#productCarousel" data-bs-slide="prev">
                        <i class="lni lni-arrow-left"></i>
                    </button>
                    <button class="carousel-control-next changing_btn" type="button" 
                            data-bs-target="#productCarousel" data-bs-slide="next">
                        <i class="lni lni-arrow-right"></i>
                    </button>`);
                }
            }

            // Remove and re-add navigation buttons if multiple images exist
            $(".carousel-control-prev, .carousel-control-next").remove();
            if (images.length > 1) {
                $("#productCarousel").append(`
        <button class="carousel-control-prev changing_btn" type="button" 
                data-bs-target="#productCarousel" data-bs-slide="prev">
            <i class="lni lni-arrow-left"></i>
        </button>
        <button class="carousel-control-next changing_btn" type="button" 
                data-bs-target="#productCarousel" data-bs-slide="next">
            <i class="lni lni-arrow-right"></i>
        </button>`);
            }

            // Enable Touch Swipe for Mobile Users
            let carouselElement = document.querySelector("#productCarousel");
            let touchStartX = 0;
            let touchEndX = 0;

            carouselElement.addEventListener("touchstart", (e) => {
                touchStartX = e.changedTouches[0].screenX;
            });

            carouselElement.addEventListener("touchend", (e) => {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            });

            function handleSwipe() {
                if (touchEndX < touchStartX) {
                    new bootstrap.Carousel(carouselElement).next();
                }
                if (touchEndX > touchStartX) {
                    new bootstrap.Carousel(carouselElement).prev();
                }
            }
            let prod_btns = $("#prod_btns");

            // Check if the button already exists
            if (prod_btns.find(`.add-to-fav`).length === 0) {
                let add_to_fav_btn = `<a href="#" data-product-id="${data.id}" class="mb-2 ml-2 btn btn-danger add-to-fav">
                <i class="fa fa-heart" aria-hidden="true"></i>
                </a>`;
                prod_btns.append(add_to_fav_btn);
            }

            // Populate Product Details
            $("#productTitle").text(data.product_title || "No Title Available");
            $("#sellingtype").text(data.selling_type);
            if (data.selling_type.includes('Auction')) {
                $("#biddinginfo").removeClass("d-none")
                $("#sellingtype").removeClass("fixed-price-box");
                $("#sellingtype").addClass("auction-box");
            }
            else {
                $("#biddinginfo").addClass("d-none")
                $("#sellingtype").removeClass("auction-box");
                $("#sellingtype").addClass("fixed-price-box");
            }
            $("#productTitlebtm").text(data.product_title || "No Title Available");
            if (data.selling_type.includes('Auction')) {
                $("#productPrice").text(data.current_bid_price ? `$${data.current_bid_price}` : "N/A");
                $("#productPrice").removeClass("selling_price")
                $("#productPrice").addClass("bid")
            }
            else {
                $("#productPrice").text(data.product_price ? `$${data.product_price}` : "Price Not Available");
                $("#productPrice").addClass("selling_price")
                $("#productPrice").removeClass("bid")
            }
            $("#productAvailability").text(data.product_availability_status || "Unknown");
            $("#productStock").text(data.product_availability_quantity || "Not Specified");
            $("#productSold").text(data.product_sold_quantity || "Not Specified");
            $("#productDescription").text(data.description || "No description available.");

            // Auction Info
            $("#auctionId").text(data.auction_id || "N/A");
            $("#currentBid").text(data.current_bid_price ? `$${data.current_bid_price}` : "N/A");
            $("#highestBidder").text(data.highest_bidder || "No Bids");
            $("#bidCount").text(data.current_bid_count || "0");

            // Condition Info
            $("#condition").text(data.condition || "N/A");
            let conditionText = `${data.condition || ''} ${data.condition_descriptors_list || ''} ${data.condition_values || ''} ${data.condition_additional_info || ''}`.trim();

            $("#conditionInfo").text(conditionText || "No details available");


            // Shipping Info
            $("#shippingInfo").text(data.shipping_cost || "Not Available");
            $("#estArrival").text(data.estimated_arrival || "Unknown");

            // Return Policy
            $("#returnAccepted").text(data.return_terms_returns_accepted || "N/A");
            $("#refundMethod").text(data.return_terms_refund_method || "N/A");
            $("#returnPeriod").text(data.return_terms_return_period_value ?
                `${data.return_terms_return_period_value} ${data.return_terms_return_period_unit}` : "N/A");

            // Additional Info
            $("#productBrand").text(data.brand || "N/A");
            $("#productCategory").text(data.category || "N/A");

            // Website & Product Links
            if (data.website_url) {
                $("#websiteUrl").attr("href", data.website_url).text(data.website_name || "Website").parent().show();
            } else {
                $("#websiteUrl").parent().hide();
            }

            if (data.product_link) {
                $("#productLink").attr("href", data.product_link).text("View Product").parent().show();
            } else {
                $("#productLink").parent().hide();
            }

            // Show the modal
            $("#productModal").modal("show");
        })
            .catch(error => console.error("Error fetching product details:", error));
    });
</script>

{% endblock %}